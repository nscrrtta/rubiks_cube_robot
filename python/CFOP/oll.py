from Cube.constants import *
from Cube.cube import Cube


class OLL:

    def solve_oll(self, cubes: list[Cube]):
        for cube in cubes: self._solve_oll(cube)


    def _solve_oll(self, cube: Cube):
        
        def get_char(i: int) -> str:
            t, f = ('x', 'o') if 18 <= i <= 26 else ('-', ' ')
            return t if cube.squares[i] == cube.squares[22] else f

        indices = [
                6,  7,  8,
            11, 18, 19, 20, 27,
            14, 21, 22, 23, 30,
            17, 24, 25, 26, 33,
                45, 46, 47
        ]

        for _ in range(4):
            diagram = ''.join(get_char(i) for i in indices)
            if diagram in oll_dict: break
            cube.make_move(U)

        for move in oll_dict[diagram]:
            cube.make_move(move)


# All 58 possible scenarios for OLL
oll_dict = {''.join(key): val for key, val in {

    # Cross shapes
    (       ' ',' ',' ',
        '-','o','x','o','-',
        ' ','x','x','x',' ',
        '-','o','x','o','-',
            ' ',' ',' ',
    ): [R, U, Ri, U, R, Ui, Ri, U, R, U2, Ri],

    (       ' ',' ','-',
        '-','o','x','o',' ',
        ' ','x','x','x',' ',
        '-','o','x','o',' ',
            ' ',' ','-',
    ): [R, U2, R2, Ui, R2, Ui, R2, U2, R],

    (       ' ',' ',' ',
        ' ','x','x','x',' ',
        ' ','x','x','x',' ',
        ' ','o','x','o',' ',
            '-',' ','-',
    ): [R2, D, Ri, U2, R, Di, Ri, U2, Ri],

    (       '-',' ',' ',
        ' ','o','x','x',' ',
        ' ','x','x','x',' ',
        ' ','o','x','x',' ',
            '-',' ',' ',
    ): [r, U, Ri, Ui, ri, F, R, Fi],

    (       ' ',' ',' ',
        ' ','x','x','o','-',
        ' ','x','x','x',' ',
        ' ','o','x','x',' ',
            '-',' ',' ',
    ): [F, Ri, Fi, r, U, R, Ui, ri],

    (       ' ',' ',' ',
        '-','o','x','x',' ',
        ' ','x','x','x',' ',
        ' ','o','x','o','-',
            '-',' ',' ',
    ): [R, U2, Ri, Ui, R, Ui, Ri],

    (       '-',' ',' ',
        ' ','o','x','o','-',
        ' ','x','x','x',' ',
        ' ','x','x','o',' ',
            ' ',' ','-',
    ): [R, U, Ri, U, R, U2, Ri],

    # All corners oriented

    (       ' ',' ',' ',
        ' ','x','x','x',' ',
        ' ','x','x','o','-',
        ' ','x','o','x',' ',
            ' ','-',' ',
    ): [r, U, Ri, Ui, ri, R, U, R, Ui, Ri],

    (       ' ','-',' ',
        ' ','x','o','x',' ',
        ' ','x','x','x',' ',
        ' ','x','o','x',' ',
            ' ','-',' ',
    ): [R, U, Ri, Ui, Mi, U, R, Ui, ri],

    # T shapes

    (       '-','-',' ',
        ' ','o','o','x',' ',
        ' ','x','x','x',' ',
        ' ','o','o','x',' ',
            '-','-',' ',
    ): [R, U, Ri, Ui, Ri, F, R, Fi],

    (       ' ','-',' ',
        '-','o','o','x',' ',
        ' ','x','x','x',' ',
        '-','o','o','x',' ',
            ' ','-',' ',
    ): [F, R, U, Ri, Ui, Fi],

    # W shapes

    (       ' ',' ','-',
        ' ','x','x','o',' ',
        '-','o','x','x',' ',
        '-','o','o','x',' ',
            ' ','-',' ',
    ): [Li, Ui, L, Ui, Li, U, L, U, L, Fi, Li, F],

    (       '-',' ',' ',
        ' ','o','x','x',' ',
        ' ','x','x','o','-',
        ' ','x','o','o','-',
            ' ','-',' ',
    ): [R, U, Ri, U, R, Ui, Ri, Ui, Ri, F, R, Fi],

    # Square shapes

    (       ' ',' ',' ',
        ' ','x','x','o','-',
        ' ','x','x','o','-',
        '-','o','o','o',' ',
            ' ','-','-',
    ): [li, U2, L, U, Li, U, l],

    (       ' ',' ',' ',
        '-','o','x','x',' ',
        '-','o','x','x',' ',
        ' ','o','o','o','-',
            '-','-',' ',
    ): [r, U2, Ri, Ui, R, Ui, ri],

    # P shapes

    (       '-',' ',' ',
        ' ','o','x','x',' ',
        '-','o','x','x',' ',
        ' ','o','o','x',' ',
            '-','-',' ',
    ): [Ri, Ui, F, U, R, Ui, Ri, Fi, R],

    (       ' ',' ','-',
        ' ','x','x','o',' ',
        ' ','x','x','o','-',
        ' ','x','o','o',' ',
            ' ','-','-',
    ): [L, U, Fi, Ui, Li, U, L, F, Li],

    (       ' ',' ',' ',
        ' ','x','x','x',' ',
        ' ','x','x','o','-',
        ' ','o','o','o',' ',
            '-','-','-',
    ): [Ri, Ui, Fi, U, F, R],

    (       ' ',' ',' ',
        ' ','x','x','o','-',
        ' ','x','x','o','-',
        ' ','x','o','o','-',
            ' ','-',' ',
    ): [F, U, R, Ui, Ri, Fi],

    # Fish shapes

    (       ' ',' ','-',
        '-','o','x','o',' ',
        ' ','x','x','o','-',
        ' ','o','o','x',' ',
            '-','-',' ',
    ): [R, U, Ri, Ui, Ri, F, R2, U, Ri, Ui, Fi],

    (       '-',' ',' ',
        ' ','o','x','o','-',
        ' ','x','x','o','-',
        '-','o','o','x',' ',
            ' ','-',' ',
    ): [r, R2, U2, R, U, Ri, U, R, U, R, ri],

    (       ' ','-',' ',
        ' ','x','o','o','-',
        '-','o','x','x',' ',
        ' ','o','x','x',' ',
            '-',' ',' ',
    ): [R, U2, R2, F, R, Fi, R, U2, Ri],

    (       ' ',' ',' ',
        ' ','x','x','o','-',
        ' ','x','x','o','-',
        ' ','o','o','x',' ',
            '-','-',' ',
    ): [F, Ri, Fi, R, U, R, Ui, Ri],

    # C shapes

    (       '-',' ',' ',
        ' ','o','x','x',' ',
        '-','o','x','o','-',
        ' ','o','x','x',' ',
            '-',' ',' ',
    ): [f, R, fi, Ui, ri, Ui, R, U, Mi],

    (       ' ',' ',' ',
        ' ','x','x','o','-',
        '-','o','x','o','-',
        ' ','x','x','o','-',
            ' ',' ',' ',
    ): [Ri, Ui, Ri, F, R, Fi, U, R],

    # Small lightning bolts

    (       '-',' ',' ',
        ' ','o','x','o','-',
        ' ','x','x','o','-',
        ' ','x','o','o',' ',
            ' ','-','-',
    ): [r, U, Ri, U, R, U2, ri],

    (       ' ',' ','-',
        '-','o','x','o',' ',
        '-','o','x','x',' ',
        ' ','o','o','x',' ',
            '-','-',' ',
    ): [li, Ui, L, Ui, Li, U2, l],

    (       '-',' ',' ',
        ' ','o','x','x',' ',
        ' ','x','x','o','-',
        '-','o','o','o',' ',
            ' ','-','-',
    ): [Si, U2, R, U, Ri, U, R, U2, Ri, S],

    (       ' ',' ','-',
        ' ','x','x','o',' ',
        '-','o','x','x',' ',
        ' ','o','o','o','-',
            '-','-',' ',
    ): [Mi, Ri, Ui, R, Ui, Ri, U2, R, Ui, R, ri],

    # Big lightning bolts

    (       ' ','-',' ',
        '-','o','o','x',' ',
        ' ','x','x','x',' ',
        ' ','x','o','o',' ',
            ' ','-','-',
    ): [fi, L, F, Li, Ui, Li, U, L, S],

    (       ' ','-',' ',
        ' ','x','o','o','-',
        ' ','x','x','x',' ',
        ' ','o','o','x',' ',
            '-','-',' ',
    ): [f, Ri, Fi, R, U, R, Ui, Ri, Si],

    # Small L shapes

    (       '-',' ','-',
        ' ','o','x','o',' ',
        ' ','x','x','o','-',
        '-','o','o','o','-',
            ' ','-',' ',
    ): [F, Ri, Fi, R, U2, R, Ui, Ri, U, R, U2, Ri],

    (       ' ',' ','-',
        '-','o','x','o',' ',
        ' ','x','x','o','-',
        '-','o','o','o',' ',
            ' ','-','-',
    ): [F, R, U, Ri, Ui, R, U, Ri, Ui, Fi],

    (       ' ',' ','-',
        '-','o','x','o',' ',
        '-','o','x','x',' ',
        '-','o','o','o',' ',
            ' ','-','-',
    ): [r, Ui, r2, U, r2, U, r2, Ui, r],

    (       '-',' ',' ',
        ' ','o','x','o','-',
        ' ','x','x','o','-',
        ' ','o','o','o','-',
            '-','-',' ',
    ): [li, U, l2, Ui, l2, Ui, l2, U, li],

    (       ' ',' ',' ',
        '-','o','x','o','-',
        ' ','x','x','o','-',
        '-','o','o','o','-',
            ' ','-',' ',
    ): [li, Ui, L, Ui, Li, U, L, Ui, Li, U2, l],

    (       ' ',' ',' ',
        '-','o','x','o','-',
        '-','o','x','x',' ',
        '-','o','o','o','-',
            ' ','-',' ',
    ): [r, U, Ri, U, R, Ui, Ri, U, R, U2, ri],

    # Knight move shapes

    (       '-','-',' ',
        ' ','o','o','o','-',
        ' ','x','x','x',' ',
        ' ','x','o','o',' ',
            ' ','-','-',
    ): [F, U, R, Ui, R2, Fi, R, U, R, Ui, Ri],

    (       ' ','-','-',
        '-','o','o','o',' ',
        ' ','x','x','x',' ',
        ' ','o','o','x',' ',
            '-','-',' ',
    ): [Ri, F, R, U, Ri, Fi, R, F, Ui, Fi],

    (       ' ','-',' ',
        ' ','x','o','o','-',
        ' ','x','x','x',' ',
        '-','o','o','o',' ',
            ' ','-','-',
    ): [li, Ui, l, Li, Ui, L, U, li, U, l],

    (       ' ','-',' ',
        '-','o','o','x',' ',
        ' ','x','x','x',' ',
        ' ','o','o','o','-',
            '-','-',' ',
    ): [r, U, ri, R, U, Ri, Ui, r, Ui, ri],

    # I shapes

    (       '-','-',' ',
        ' ','o','o','o','-',
        ' ','x','x','x',' ',
        ' ','o','o','o','-',
            '-','-',' ',
    ): [F, U, R, Ui, Ri, U, R, Ui, Ri, Fi],

    (       ' ',' ','-',
        '-','o','x','o',' ',
        '-','o','x','o','-',
        '-','o','x','o',' ',
            ' ',' ','-',
    ): [Ri, Fi, Ui, F, Ui, R, U, Ri, U, R],

    (       '-','-','-',
        ' ','o','o','o',' ',
        ' ','x','x','x',' ',
        ' ','o','o','o',' ',
            '-','-','-',
    ): [Ri, F, U, R, Ui, R2, Fi, R2, U, Ri, Ui, R],

    (       ' ','-',' ',
        '-','o','o','o','-',
        ' ','x','x','x',' ',
        '-','o','o','o','-',
            ' ','-',' ',
    ): [r, U, ri, U, R, Ui, Ri, U, R, Ui, Mi, Ui, ri],

    # Cactus shapes

    (       '-',' ',' ',
        ' ','o','x','x',' ',
        ' ','x','x','o','-',
        ' ','o','o','x',' ',
            '-','-',' ',
    ): [l, D, li, U, l, Di, l2, U, l, Ui, li, Ui, l],

    (       ' ',' ','-',
        ' ','x','x','o',' ',
        '-','o','x','x',' ',
        ' ','x','o','o',' ',
            ' ','-','-',
    ): [ri, Di, r, Ui, ri, D, r2, Ui, ri, U, r, U, ri],

    (       '-',' ','-',
        ' ','o','x','o',' ',
        ' ','x','x','o','-',
        ' ','x','o','x',' ',
            ' ','-',' ',
    ): [R, U, Ri, U, R, U2, Ri, F, R, U, Ri, Ui, Fi],

    (       ' ',' ',' ',
        '-','o','x','x',' ',
        ' ','x','x','o','-',
        '-','o','o','x',' ',
            ' ','-',' ',
    ): [Ri, F, R, Fi, Ri, F, R, Fi, R, U, Ri, Ui, R, U, Ri],

    # No edges oriented

    (       ' ','-',' ',
        '-','o','o','o','-',
        '-','o','x','o','-',
        '-','o','o','o','-',
            ' ','-',' ',
    ): [R, U2, R2, F, R, Fi, U2, Ri, F, R, Fi],

    (       '-','-','-',
        ' ','o','o','o',' ',
        '-','o','x','o','-',
        '-','o','o','o','-',
            ' ','-',' ',
    ): [L, F, Li, U2, R, U2, Ri, U2, L, Fi, Li],

    (       '-','-',' ',
        ' ','o','o','o','-',
        '-','o','x','o','-',
        ' ','x','o','o',' ',
            ' ','-','-',
    ): [ri, R2, U, Ri, U, r, U2, ri, U, Mi],

    (       ' ','-','-',
        '-','o','o','o',' ',
        '-','o','x','o','-',
        ' ','o','o','x',' ',
            '-','-',' ',
    ): [l, L2, Ui, L, Ui, li, U2, l, Ui, Mi],

    (       ' ','-',' ',
        ' ','x','o','o','-',
        '-','o','x','o','-',
        ' ','o','o','x',' ',
            '-','-',' ',
    ): [F, Ri, Fi, R2, ri, U, R, Ui, Ri, Ui, Mi],

    (       ' ','-',' ',
        ' ','x','o','x',' ',
        '-','o','x','o','-',
        ' ','o','o','o',' ',
            '-','-','-',
    ): [r, U, Ri, U, R, U2, r2, Ui, R, Ui, Ri, U2, r],

    (       ' ','-',' ',
        ' ','x','o','x',' ',
        '-','o','x','o','-',
        '-','o','o','o','-',
            ' ','-',' ',
    ): [ri, R, U, R, U, Ri, Ui, Mi, Ri, F, R, Fi],

    (       ' ','-',' ',
        ' ','x','o','x',' ',
        '-','o','x','o','-',
        ' ','x','o','x',' ',
            ' ','-',' ',
    ): [r, U, Ri, Ui, M2, U, R, Ui, Ri, Ui, Mi],

    # Already solved

    (       ' ',' ',' ',
        ' ','x','x','x',' ',
        ' ','x','x','x',' ',
        ' ','x','x','x',' ',
            ' ',' ',' ',
    ): []
}.items()}
